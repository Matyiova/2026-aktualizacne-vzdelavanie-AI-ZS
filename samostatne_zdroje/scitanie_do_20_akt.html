<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sčítanie s výsledkom do 20</title>
    <style>
        /* Základné štýly stránky */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f8ff; /* Pozadie ostáva stále modrasté */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        h1 { color: #333; }

        /* Kontajner pre nastavenia a súhrn */
        .container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            text-align: center;
            max-width: 600px;
            width: 100%;
        }

        /* Štýly pre úvodnú obrazovku */
        .input-group { margin: 15px 0; text-align: left; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"], input[type="number"].setup-input {
            width: 100%; padding: 10px; font-size: 16px;
            border: 2px solid #ddd; border-radius: 5px; box-sizing: border-box;
        }
        button {
            background-color: #4CAF50; color: white; padding: 12px 24px;
            border: none; border-radius: 5px; font-size: 18px; cursor: pointer;
            transition: background 0.3s; margin-top: 10px;
        }
        button:hover { background-color: #45a049; }
        button.secondary { background-color: #2196F3; }
        button.secondary:hover { background-color: #0b7dda; }

        /* --- Obrazovka cvičenia --- */
        #exercise-screen {
            display: none;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
        }

        .exercise-container {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 50px;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 20px;
        }

        /* Box pre samotný príklad */
        .question-box {
            font-size: 80px; 
            font-weight: bold;
            display: flex;
            align-items: center;
            white-space: nowrap;
            line-height: 1;
        }

        /* Vstup pre odpoveď - UPRAVENÁ ŠÍRKA A PODFARBENIE */
        .answer-input {
            font-size: 80px !important; 
            width: 140px;  /* Skrátená šírka */
            height: 100px;
            text-align: center;
            border: none;
            border-bottom: 6px solid #333;
            margin-left: 15px;
            background: transparent; /* Predvolené priehľadné */
            font-weight: bold;
            color: #000;
            padding: 0;
            line-height: 100px;
            font-family: inherit;
            border-radius: 10px; /* Zaoblené rohy pre krajšie podfarbenie */
            transition: background-color 0.3s; /* Plynulá zmena farby */
        }
        .answer-input:focus { outline: none; border-bottom-color: #2196F3; }
        
        .answer-input::-webkit-outer-spin-button, .answer-input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        .answer-input { -moz-appearance: textfield; }

        /* Farby pre spätnú väzbu (aplikujú sa na INPUT) */
        .correct-bg { background-color: #b2dcb4 !important; color: black !important; border-bottom-color: transparent !important; }
        .incorrect-bg { background-color: #f8b5b4 !important; color: black !important; border-bottom-color: transparent !important; }

        /* --- Klávesnica --- */
        .keypad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            min-width: 250px;
        }

        .key {
            padding: 15px;
            font-size: 1.8em;
            font-weight: bold;
            background-color: #d0d0d0;
            color: #000000;
            border: 2px solid #999;
            border-radius: 8px;
            cursor: pointer;
            user-select: none;
            transition: all 0.1s;
        }
        .key:hover { background-color: #c0c0c0; }
        .key:active { background-color: #a0a0a0; transform: translateY(2px); }

        .key-enter { background-color: #4CAF50; color: white; grid-column: span 3; border-color: #388E3C; }
        .key-enter:hover { background-color: #45a049; }
        .key-backspace { background-color: #ff9800; color: white; border-color: #F57C00; font-size: 1.5em;}
        .key-backspace:hover { background-color: #fb8c00; }
        .key-clear { background-color: #f44336; color: white; border-color: #D32F2F; }
        .key-clear:hover { background-color: #e53935; }

        /* --- Obrazovka súhrnu --- */
        #summary-screen { display: none; text-align: left; }
        .summary-item { margin: 10px 0; font-size: 1.2em; border-bottom: 1px solid #eee; padding-bottom: 5px; }
    </style>
</head>
<body>

    <div class="container" id="setup-screen">
        <h1>Sčítanie s výsledkom do 20</h1>
        <div class="input-group">
            <label for="student-name">Meno žiaka:</label>
            <input type="text" id="student-name" placeholder="Zadajte meno">
        </div>
        <div class="input-group">
            <label for="question-count">Počet príkladov:</label>
            <input type="number" class="setup-input" id="question-count" value="10" min="1" max="50">
        </div>
        <button onclick="startExercise()">Spustiť cvičenie</button>
    </div>

    <div id="exercise-screen" style="display: none;">
        <div class="exercise-container">
            <div class="question-box">
                <span id="question-text">1 + 1 =</span>
                <input type="number" id="user-answer" class="answer-input" autocomplete="off">
            </div>
            
            <div class="keypad">
                <button class="key" onclick="addNumber(1)">1</button>
                <button class="key" onclick="addNumber(2)">2</button>
                <button class="key" onclick="addNumber(3)">3</button>
                <button class="key" onclick="addNumber(4)">4</button>
                <button class="key" onclick="addNumber(5)">5</button>
                <button class="key" onclick="addNumber(6)">6</button>
                <button class="key" onclick="addNumber(7)">7</button>
                <button class="key" onclick="addNumber(8)">8</button>
                <button class="key" onclick="addNumber(9)">9</button>
                <button class="key key-backspace" onclick="backspace()">⌫</button>
                <button class="key" onclick="addNumber(0)">0</button>
                <button class="key key-clear" onclick="clearInput()">C</button>
                <button class="key key-enter" onclick="checkAnswer()">Enter</button>
            </div>
        </div>
    </div>

    <div class="container" id="summary-screen">
        <h1>Celkové vyhodnotenie</h1>
        <div class="summary-item"><strong>Názov cvičenia:</strong> Sčítanie s výsledkom do 20</div>
        <div class="summary-item"><strong>Meno žiaka:</strong> <span id="summary-name"></span></div>
        <div class="summary-item"><strong>Hodnotenie:</strong> <span id="summary-score"></span></div>
        <div class="summary-item"><strong>Dátum a čas:</strong> <span id="summary-date"></span></div>
        
        <div style="text-align: center; margin-top: 20px;">
            <button class="secondary" onclick="showDetails()">Detailné výsledky</button>
            <br>
            <button onclick="location.reload()" style="margin-top: 10px; background-color: #666;">Nové cvičenie</button>
        </div>
    </div>

    <script>
        const rawDatabase = [
            "1 + 0 = 1", "1 + 1 = 2", "1 + 2 = 3", "1 + 3 = 4", "1 + 4 = 5", "1 + 5 = 6", "1 + 6 = 7", "1 + 7 = 8", "1 + 8 = 9", "1 + 9 = 10",
            "1 + 10 = 11", "1 + 11 = 12", "1 + 12 = 13", "1 + 13 = 14", "1 + 14 = 15", "1 + 15 = 16", "1 + 16 = 17", "1 + 17 = 18", "1 + 18 = 19", "1 + 19 = 20",
            "2 + 1 = 3", "2 + 2 = 4", "2 + 3 = 5", "2 + 4 = 6", "2 + 5 = 7", "2 + 6 = 8", "2 + 7 = 9", "2 + 8 = 10", "2 + 9 = 11", "2 + 10 = 12",
            "2 + 11 = 13", "2 + 12 = 14", "2 + 13 = 15", "2 + 14 = 16", "2 + 15 = 17", "2 + 16 = 18", "2 + 17 = 19", "2 + 18 = 20",
            "3 + 1 = 4", "3 + 2 = 5", "3 + 3 = 6", "3 + 4 = 7", "3 + 5 = 8", "3 + 6 = 9", "3 + 7 = 10", "3 + 8 = 11", "3 + 9 = 12", "3 + 10 = 13",
            "3 + 11 = 14", "3 + 12 = 15", "3 + 13 = 16", "3 + 14 = 17", "3 + 15 = 18", "3 + 16 = 19", "3 + 17 = 20",
            "4 + 1 = 5", "4 + 2 = 6", "4 + 3 = 7", "4 + 4 = 8", "4 + 5 = 9", "4 + 6 = 10", "4 + 7 = 11", "4 + 8 = 12", "4 + 9 = 13", "4 + 10 = 14",
            "4 + 11 = 15", "4 + 12 = 16", "4 + 13 = 17", "4 + 14 = 18", "4 + 15 = 19", "4 + 16 = 20",
            "5 + 1 = 6", "5 + 2 = 7", "5 + 3 = 8", "5 + 4 = 9", "5 + 5 = 10", "5 + 6 = 11", "5 + 7 = 12", "5 + 8 = 13", "5 + 9 = 14", "5 + 10 = 15",
            "5 + 11 = 16", "5 + 12 = 17", "5 + 13 = 18", "5 + 14 = 19", "5 + 15 = 20",
            "6 + 1 = 7", "6 + 2 = 8", "6 + 3 = 9", "6 + 4 = 10", "6 + 5 = 11", "6 + 6 = 12", "6 + 7 = 13", "6 + 8 = 14", "6 + 9 = 15", "6 + 10 = 16",
            "6 + 11 = 17", "6 + 12 = 18", "6 + 13 = 19", "6 + 14 = 20",
            "7 + 1 = 8", "7 + 2 = 9", "7 + 3 = 10", "7 + 4 = 11", "7 + 5 = 12", "7 + 6 = 13", "7 + 7 = 14", "7 + 8 = 15", "7 + 9 = 16", "7 + 10 = 17",
            "7 + 11 = 18", "7 + 12 = 19", "7 + 13 = 20",
            "8 + 1 = 9", "8 + 2 = 10", "8 + 3 = 11", "8 + 4 = 12", "8 + 5 = 13", "8 + 6 = 14", "8 + 7 = 15", "8 + 8 = 16", "8 + 9 = 17", "8 + 10 = 18",
            "8 + 11 = 19", "8 + 12 = 20",
            "9 + 1 = 10", "9 + 2 = 11", "9 + 3 = 12", "9 + 4 = 13", "9 + 5 = 14", "9 + 6 = 15", "9 + 7 = 16", "9 + 8 = 17", "9 + 9 = 18", "9 + 10 = 19", "9 + 11 = 20",
            "10 + 1 = 11", "10 + 2 = 12", "10 + 3 = 13", "10 + 4 = 14", "10 + 5 = 15", "10 + 6 = 16", "10 + 7 = 17", "10 + 8 = 18", "10 + 9 = 19", "10 + 10 = 20",
            "11 + 1 = 12", "11 + 2 = 13", "11 + 3 = 14", "11 + 4 = 15", "11 + 5 = 16", "11 + 6 = 17", "11 + 7 = 18", "11 + 8 = 19", "11 + 9 = 20",
            "12 + 1 = 13", "12 + 2 = 14", "12 + 3 = 15", "12 + 4 = 16", "12 + 5 = 17", "12 + 6 = 18", "12 + 7 = 19", "12 + 8 = 20",
            "13 + 1 = 14", "13 + 2 = 15", "13 + 3 = 16", "13 + 4 = 17", "13 + 5 = 18", "13 + 6 = 19", "13 + 7 = 20",
            "14 + 1 = 15", "14 + 2 = 16", "14 + 3 = 17", "14 + 4 = 18", "14 + 5 = 19", "14 + 6 = 20",
            "15 + 1 = 16", "15 + 2 = 17", "15 + 3 = 18", "15 + 4 = 19", "15 + 5 = 20",
            "16 + 1 = 17", "16 + 2 = 18", "16 + 3 = 19", "16 + 4 = 20",
            "17 + 1 = 18", "17 + 2 = 19", "17 + 3 = 20",
            "18 + 1 = 19", "18 + 2 = 20",
            "19 + 1 = 20",
            "20 + 0 = 20"
        ];

        let questions = [];
        let currentQuestionIndex = 0;
        let totalQuestions = 0;
        let studentName = "";
        let score = 0;
        let currentAttempts = [];
        let allResults = [];
        let firstTry = true;

        function parseDatabase() {
            return rawDatabase.map(item => {
                const parts = item.split('=');
                return {
                    text: parts[0].trim() + " =",
                    correct: parseInt(parts[1].trim())
                };
            });
        }

        const questionDB = parseDatabase();

        function startExercise() {
            const nameInput = document.getElementById('student-name').value.trim();
            studentName = nameInput !== "" ? nameInput : "XY";
            
            const countInput = document.getElementById('question-count').value;
            totalQuestions = parseInt(countInput);
            
            if (isNaN(totalQuestions) || totalQuestions < 1) {
                alert("Zadajte platný počet príkladov.");
                return;
            }

            questions = [];
            
            // --- ZAČIATOK ZMENY: Miešanie príkladov bez opakovania ---
            
            // 1. Vytvoríme kópiu celej databázy
            let tempDB = [...questionDB];

            // 2. Náhodne zamiešame (Fisher-Yates shuffle)
            for (let i = tempDB.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [tempDB[i], tempDB[j]] = [tempDB[j], tempDB[i]];
            }

            // 3. Zoberieme len toľko príkladov, koľko užívateľ chcel.
            // (Math.min zabezpečí, že ak by chcel viac príkladov ako je v DB, program nespadne)
            const actualCount = Math.min(totalQuestions, tempDB.length);
            
            // Ak by užívateľ zadal viac otázok ako existuje, opravíme totalQuestions, 
            // aby sedelo vyhodnotenie
            totalQuestions = actualCount; 

            questions = tempDB.slice(0, actualCount);
            
            // --- KONIEC ZMENY ---

            currentQuestionIndex = 0;
            score = 0;
            allResults = [];

            document.getElementById('setup-screen').style.display = 'none';
            document.getElementById('exercise-screen').style.display = 'flex';
            
            loadQuestion();
        }

        function loadQuestion() {
            if (currentQuestionIndex >= totalQuestions) {
                finishExercise();
                return;
            }

            const q = questions[currentQuestionIndex];
            document.getElementById('question-text').innerText = q.text;
            const input = document.getElementById('user-answer');
            input.value = "";
            
            // Reset farieb inputu pri novej otázke
            input.classList.remove('correct-bg', 'incorrect-bg');
            input.focus();
            
            currentAttempts = [];
            firstTry = true;
        }

        // Pomocná funkcia na reset farby pri oprave
        function resetInputColor() {
            const input = document.getElementById('user-answer');
            if (input.classList.contains('incorrect-bg')) {
                input.classList.remove('incorrect-bg');
            }
        }

        function addNumber(num) {
            resetInputColor(); // Ak bola chyba, zmaže červenú
            const input = document.getElementById('user-answer');
            input.value += num;
            input.focus();
        }

        function backspace() {
            resetInputColor(); // Ak bola chyba, zmaže červenú
            const input = document.getElementById('user-answer');
            input.value = input.value.slice(0, -1);
            input.focus();
        }

        function clearInput() {
            resetInputColor();
            const input = document.getElementById('user-answer');
            input.value = "";
            input.focus();
        }

        function checkAnswer() {
            const input = document.getElementById('user-answer');
            const answer = parseInt(input.value);
            const currentQ = questions[currentQuestionIndex];
            
            if (isNaN(answer)) return;

            if (answer === currentQ.correct) {
                // Správna odpoveď - zelený input
                input.classList.remove('incorrect-bg');
                input.classList.add('correct-bg');
                
                currentAttempts.push({ val: answer, correct: true });
                
                if (firstTry) score++;

                allResults.push({
                    question: currentQ.text + " " + currentQ.correct,
                    attempts: [...currentAttempts]
                });

                setTimeout(() => {
                    input.classList.remove('correct-bg');
                    currentQuestionIndex++;
                    loadQuestion();
                }, 1000);

            } else {
                // Nesprávna odpoveď - červený input
                input.classList.remove('correct-bg');
                input.classList.add('incorrect-bg');
                
                currentAttempts.push({ val: answer, correct: false });
                firstTry = false;
                input.focus();
            }
        }

        function finishExercise() {
            document.getElementById('exercise-screen').style.display = 'none';
            document.getElementById('summary-screen').style.display = 'block';

            const percentage = Math.round((score / totalQuestions) * 100);
            const now = new Date();
            const dateStr = now.toLocaleDateString('sk-SK') + " " + now.toLocaleTimeString('sk-SK');

            document.getElementById('summary-name').innerText = studentName;
            document.getElementById('summary-score').innerText = `${score} z ${totalQuestions} (${percentage}%)`;
            document.getElementById('summary-date').innerText = dateStr;
        }

        function showDetails() {
            const percentage = Math.round((score / totalQuestions) * 100);
            const now = new Date();
            const dateStr = now.toLocaleDateString('sk-SK') + " " + now.toLocaleTimeString('sk-SK');

            let tableRows = "";
            allResults.forEach(res => {
                let attemptsHtml = res.attempts.map(att => {
                    return `${att.val} <span style="color:${att.correct ? 'green' : 'red'}">${att.correct ? '&#10004;' : '&#10008;'}</span>`;
                }).join(", ");
                tableRows += `<tr><td>${res.question}</td><td>${attemptsHtml}</td></tr>`;
            });

            const htmlContent = `
                <!DOCTYPE html>
                <html lang="sk">
                <head>
                    <title>Detailné výsledky - ${studentName}</title>
                    <style>
                        body { font-family: sans-serif; padding: 20px; }
                        h1 { color: #333; }
                        .header-info { margin-bottom: 20px; border-bottom: 2px solid #333; padding-bottom: 10px; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #f2f2f2; }
                        .legend { margin-top: 20px; font-size: 0.9em; color: #555; }
                        @media print { button { display: none; } }
                    </style>
                </head>
                <body>
                    <h1>Detailný prehľad</h1>
                    <div class="header-info">
                        <strong>Názov cvičenia:</strong> Sčítanie s výsledkom do 20<br>
                        <strong>Meno žiaka:</strong> ${studentName}<br>
                        <strong>Hodnotenie:</strong> ${score} z ${totalQuestions} (${percentage}%)<br>
                        <strong>Dátum a čas:</strong> ${dateStr}
                    </div>
                    <table>
                        <thead><tr><th>Príklad (správne riešenie)</th><th>Tvoje riešenia</th></tr></thead>
                        <tbody>${tableRows}</tbody>
                    </table>
                    <div class="legend"><strong>Legenda:</strong> &#10004; = Správne, &#10008; = Nesprávne</div>
                    <button onclick="window.print()" style="margin-top:20px; padding:10px 20px; cursor:pointer;">Tlačiť (Ctrl + P)</button>
                </body>
                </html>
            `;
            const win = window.open("", "_blank");
            win.document.write(htmlContent);
            win.document.close();
        }

        document.addEventListener('keydown', function(event) {
            if (document.getElementById('exercise-screen').style.display !== 'none') {
                const input = document.getElementById('user-answer');
                input.focus();
                
                // Reset farby aj pri písaní na fyzickej klávesnici
                if (!isNaN(parseInt(event.key)) || event.key === "Backspace" || event.key === "Delete") {
                    resetInputColor();
                }

                if (event.key === "Enter") {
                    event.preventDefault();
                    checkAnswer();
                }
            }
        });
    </script>
	  <br><br>
  <b>Spracovala pomocou UI:</b> Mgr. Erika Matyiová (2026)
    </div>
</body>
</html>