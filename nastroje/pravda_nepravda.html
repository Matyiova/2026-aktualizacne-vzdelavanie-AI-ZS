<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <title>Gener√°tor cviƒçen√≠ pravda/nepravda</title>
  <style>
    body { font-family: Courier bold, monospace; padding: 20px; }
    textarea, input { width: 100%; margin-bottom: 10px; padding: 8px; }
    button { padding: 10px 20px; font-size: 16px; }
  </style>
</head>
<body>
  <h1>Gener√°tor cviƒçen√≠: Pravda / Nepravda</h1>

  <label for="pairs">Zadaj p√°ry pojem[TAB]defin√≠cia (ka≈æd√Ω p√°r na nov√Ω riadok):</label>
  <textarea id="pairs" rows="10" placeholder="napr. Hund[TAB]pes"></textarea>

  <label for="title">N√°zov cviƒçenia:</label>
  <input type="text" id="title" placeholder="napr. Zvierat√° ‚Äì nemecky">

  <button onclick="generateExercise()">Generova≈• HTML</button>

  <script>
    // Naƒç√≠tanie ulo≈æen√Ωch hodn√¥t
    window.addEventListener('DOMContentLoaded', () => {
      const savedPairs = localStorage.getItem('pairsInput');
      const savedTitle = localStorage.getItem('titleInput');
      if (savedPairs) document.getElementById('pairs').value = savedPairs;
      if (savedTitle) document.getElementById('title').value = savedTitle;
    });

    // Ukladanie do localStorage
    document.getElementById('pairs').addEventListener('input', function() {
      localStorage.setItem('pairsInput', this.value);
    });
    document.getElementById('title').addEventListener('input', function() {
      localStorage.setItem('titleInput', this.value);
    });

    // Povolenie TAB vo vstupe
    document.getElementById('pairs').addEventListener('keydown', function(e) {
      if (e.key === 'Tab') {
        e.preventDefault();
        const start = this.selectionStart;
        const end = this.selectionEnd;
        this.value = this.value.substring(0, start) + '\t' + this.value.substring(end);
        this.selectionStart = this.selectionEnd = start + 1;
      }
    });

    function generateExercise() {
      const rawPairs = document.getElementById('pairs').value.trim().split('\n');
      const title = document.getElementById('title').value.trim();
      const pairs = rawPairs.map(line => {
        const [term, definition] = line.split('\t');
        return { term, definition };
      });

      const htmlContent = `
<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <title>${title}</title>
  <style>
    body { font-family: Courier bold, monospace; padding: 20px; }
    .columns { display: flex; gap: 20px; margin-top: 20px; }
    .column { flex: 1; padding: 10px; min-height: 300px; border: 1px solid #ccc; }
    .correct { background-color: #c8f7c5; }
    .incorrect { background-color: #f7c5d1; }
    .pair { margin-bottom: 10px; }
    .error { color: red; font-weight: bold; margin-top: 10px; }
    .score { margin-top: 20px; font-size: 18px; }
    .emoji { text-align: center; font-size: 2em; }
  </style>
</head>
<body>
  <h1>Spr√°vne alebo nespr√°vne?</h1>
  <h2>${title}</h2>

  <label for="count">Poƒçet p√°rov na jedno cviƒçenie:</label>
  <input type="number" id="count" min="1" max="${pairs.length * 2}" value="10">
  <button onclick="startGame()">Spusti≈• hru</button>

  <div id="gameArea"></div>
  <div id="errorMsg" class="error"></div>

  <div class="columns">
    <div class="column correct" onclick="handleClick(true)">
      <div class="emoji">üôÇ</div>
      <strong>‚úÖ Spr√°vne</strong>
      <div id="correctList"></div>
    </div>
    <div class="column incorrect" onclick="handleClick(false)">
      <div class="emoji">üôÅ</div>
      <strong>‚ùå Nespr√°vne</strong>
      <div id="incorrectList"></div>
    </div>
  </div>

  <div id="score" class="score"></div>

  <script>
    const basePairs = ${JSON.stringify(pairs)};
    let questionSet = [];
    let currentIndex = 0;
    let correctAnswers = 0;
    let totalQuestions = 0;
    let firstAttempt = true;

    function startGame() {
      const count = parseInt(document.getElementById('count').value);
      totalQuestions = count;
      correctAnswers = 0;
      currentIndex = 0;
      document.getElementById('correctList').innerHTML = '';
      document.getElementById('incorrectList').innerHTML = '';
      document.getElementById('score').innerText = \`Sk√≥re: 0/\${totalQuestions} bodov (0%)\`;
      document.getElementById('errorMsg').innerText = '';

      // Spr√°vne p√°ry
      const correctPairs = basePairs.map(p => ({
        term: p.term,
        definition: p.definition,
        isCorrect: true
      }));

      // Nespr√°vne p√°ry
      const incorrectPairs = [];
      basePairs.forEach(p => {
        let wrongDef;
        do {
          wrongDef = basePairs[Math.floor(Math.random() * basePairs.length)].definition;
        } while (wrongDef === p.definition);
        incorrectPairs.push({
          term: p.term,
          definition: wrongDef,
          isCorrect: false
        });
      });

      // 50:50 pomer
      const half = Math.floor(count / 2);
      const selectedCorrect = correctPairs.sort(() => Math.random() - 0.5).slice(0, half);
      const selectedIncorrect = incorrectPairs.sort(() => Math.random() - 0.5).slice(0, count - half);

      // Spoj√≠me a premie≈°ame
      questionSet = [...selectedCorrect, ...selectedIncorrect].sort(() => Math.random() - 0.5);

      showCurrentPair();
    }

    function showCurrentPair() {
      if (currentIndex >= totalQuestions) {
        document.getElementById('gameArea').innerHTML = '<strong>Cviƒçenie je dokonƒçen√© üôÇ</strong>';
        document.getElementById('score').innerText =
          \`Sk√≥re: \${correctAnswers}/\${totalQuestions} bodov (\${Math.round((correctAnswers / totalQuestions) * 100)}%)\`;
        return;
      }

      const q = questionSet[currentIndex];
      firstAttempt = true;
      document.getElementById('errorMsg').innerText = '';
      document.getElementById('gameArea').innerHTML =
        \`<div id="currentDisplay" class="pair"><strong>\${q.term}</strong>: \${q.definition}</div>\`;
    }

    function handleClick(userThinksCorrect) {
      const q = questionSet[currentIndex];
      const isUserCorrect = userThinksCorrect === q.isCorrect;

      if (isUserCorrect) {
        const container = q.isCorrect ? 'correctList' : 'incorrectList';
        const div = document.createElement('div');
        div.innerText = \`\${q.term}: \${q.definition}\`;
        div.style.color = 'black';
        document.getElementById(container).appendChild(div);

        if (firstAttempt) correctAnswers++;

        // Aktualiz√°cia priebe≈æn√©ho sk√≥re
        document.getElementById('score').innerText =
          \`Sk√≥re: \${correctAnswers}/\${totalQuestions} bodov (\${Math.round((correctAnswers / totalQuestions) * 100)}%)\`;

        currentIndex++;
        showCurrentPair();
      } else {
        document.getElementById('errorMsg').innerText = 'Sk√∫s to znova.';
        document.getElementById('currentDisplay').style.color = 'red';
        firstAttempt = false;
      }
    }
  <\/script>
   <br><br>
  <b>Spracovala pomocou UI:</b> Mgr. Erika Matyiov√° (2025)
  <br><br>
</body>
</html>
      `;

      const blob = new Blob([htmlContent], { type: "text/html" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "cvicenie.html";
      link.click();
	   // --- koniec funkcie generateExercise ---
    }
 </script>
 <br><br>
  <b>Spracovala pomocou UI:</b> Mgr. Erika Matyiov√° (2025)
  <br><br>
</body>
</html>