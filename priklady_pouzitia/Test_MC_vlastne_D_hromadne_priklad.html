<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <title>Orient√°cia v ƒçase - test s v√Ωberom odpovede</title>
  <style>
    :root { --bg-light:#fff; --text-light:#000; --bg-dark:#001f3f; --text-dark:#fff; }
    body { font-family:Courier bold,monospace; font-size:120%; padding:20px; margin:0; background:var(--bg-light); color:var(--text-light); transition:0.3s; }
    body.dark-mode { background:var(--bg-dark); color:var(--text-dark); }
    #themeToggle { position:fixed; top:15px; right:15px; z-index:100; padding:6px 12px; border:none; border-radius:4px; background:#ddd; cursor:pointer; transition:0.3s; }
    #themeToggle.dark { background:#444; color:#fff; }
    .question-block { border:1px solid #ccc; padding:10px; margin:10px 0; border-radius:4px; }
    .question-title { font-weight:bold; margin-bottom:5px; }
    .answers label { display:block; margin:4px 0; padding:4px; border-radius:3px; cursor:pointer; }
    .missing { background:#ffe6b3; }
    .correct { background:#c8f7c5; }
    .incorrect { background:#f7c5d1; }
    body.dark-mode .missing, body.dark-mode .correct, body.dark-mode .incorrect { color:#000; }
    /* Start screen styles */
    #startScreen { border: 2px solid #ccc; padding: 20px; border-radius: 8px; max-width: 600px; margin-top: 20px; }
    .start-input { display: block; margin-bottom: 15px; width: 100%; padding: 8px; box-sizing: border-box; font-size: 1rem; }
    #startBtn { padding: 10px 25px; font-size: 1.2rem; background-color: #4CAF50; color: white; border: none; cursor: pointer; border-radius: 4px; }
    #startBtn:hover { background-color: #45a049; }
    /* Results styles */
    #results { margin-top:30px; padding:15px; border-top: 2px solid #ccc; }
    .detail-btn { background-color: #008CBA; color: white; border: none; padding: 10px 20px; font-size: 1rem; cursor: pointer; border-radius: 4px; margin-top: 15px; }
  </style>
</head>
<body>
  <button id="themeToggle">üåô Tmav√Ω re≈æim</button>
  <h2>Orient√°cia v ƒçase - test s v√Ωberom odpovede</h2>
  <div style="margin-top:-15px; margin-bottom:20px; font-style:italic; opacity:0.8;">Autor: Mgr. Erika Matyiov√° | Rok: 2026</div>
  <div id="startScreen">
    <label><b>Meno ≈æiaka, trieda:</b></label>
    <input type="text" id="inputName" class="start-input" placeholder="Zadajte va≈°e meno (nepovinn√©)">
    <label><b>Poƒçet ot√°zok (max 19):</b></label>
    <input type="number" id="inputCount" class="start-input" value="19" min="1" max="19">
    <button id="startBtn" onclick="startTest()">≈†tart</button>
  </div>
  <form id="quizForm" style="display:none;"></form>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var btn = document.getElementById('themeToggle');
      if (localStorage.getItem('theme') === 'dark') {
        document.body.classList.add('dark-mode');
        btn.classList.add('dark');
        btn.textContent = '‚òÄÔ∏è Svetl√Ω re≈æim';
      }
      btn.addEventListener('click', function() {
        var dark = document.body.classList.toggle('dark-mode');
        btn.classList.toggle('dark');
        btn.textContent = dark ? '‚òÄÔ∏è Svetl√Ω re≈æim' : 'üåô Tmav√Ω re≈æim';
        localStorage.setItem('theme', dark ? 'dark' : 'light');
      });
    });

    var originalQuestions = [{"term":"pondelok je","correct":"1. de≈à v t√Ω≈ædni","answers":["7. de≈à v t√Ω≈ædni","3. de≈à v t√Ω≈ædni"]},{"term":"utorok je","correct":"2. de≈à v t√Ω≈ædni","answers":["6. de≈à v t√Ω≈ædni","4. de≈à v t√Ω≈ædni"]},{"term":"streda je","correct":"3. de≈à v t√Ω≈ædni","answers":["1. de≈à v t√Ω≈ædni","5. de≈à v t√Ω≈ædni"]},{"term":"≈°tvrtok je","correct":"4. de≈à v t√Ω≈ædni","answers":["2. de≈à v t√Ω≈ædni","3. de≈à v t√Ω≈ædni"]},{"term":"piatok je","correct":"5. de≈à v t√Ω≈ædni","answers":["2. de≈à v t√Ω≈ædni","3. de≈à v t√Ω≈ædni"]},{"term":"sobota je","correct":"6. de≈à v t√Ω≈ædni","answers":["2. de≈à v t√Ω≈ædni","7. de≈à v t√Ω≈ædni"]},{"term":"nedeƒæa je","correct":"7. de≈à v t√Ω≈ædni","answers":["5. de≈à v t√Ω≈ædni","2. de≈à v t√Ω≈ædni"]},{"term":"janu√°r je","correct":"1. mesiac v roku","answers":["3. mesiac v roku","5. mesiac v roku"]},{"term":"febru√°r je","correct":"2. mesiac v roku","answers":["1. mesiac v roku","6. mesiac v roku"]},{"term":"marec je","correct":"3. mesiac v roku","answers":["5. mesiac v roku","8. mesiac v roku"]},{"term":"apr√≠l je","correct":"4. mesiac v roku","answers":["9. mesiac v roku","2. mesiac v roku"]},{"term":"m√°j je","correct":"5. mesiac v roku","answers":["10. mesiac v roku","12. mesiac v roku"]},{"term":"j√∫n je","correct":"6. mesiac v roku","answers":["5. mesiac v roku","1. mesiac v roku"]},{"term":"j√∫l je","correct":"7. mesiac v roku","answers":["4. mesiac v roku","10. mesiac v roku"]},{"term":"august je","correct":"8. mesiac v roku","answers":["3. mesiac v roku","2. mesiac v roku"]},{"term":"september je","correct":"9. mesiac v roku","answers":["7. mesiac v roku","4. mesiac v roku"]},{"term":"okt√≥ber je","correct":"10. mesiac v roku","answers":["8. mesiac v roku","1. mesiac v roku"]},{"term":"november je","correct":"11. mesiac v roku","answers":["2. mesiac v roku","7. mesiac v roku"]},{"term":"december je","correct":"12. mesiac v roku","answers":["1. mesiac v roku","4. mesiac v roku"]}];
    var numberingType = 'alpha';
    var testTitleName = 'Orient√°cia v ƒçase - test s v√Ωberom odpovede';
    window.qs = [];

    // Glob√°lne premenn√© pre v√Ωsledky
    var resultData = { name: '', score: 0, percent: 0, date: '' };

    function shuffle(a){ for (var i=a.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1)); var t=a[i]; a[i]=a[j]; a[j]=t;} return a; }
    function pick(a,n){ return shuffle(a.slice()).slice(0,n); }

    function getQuestionPrefix(index) {
       if (numberingType === 'alpha') {
         return String.fromCharCode(65 + index) + '.';
       } else {
         return (index + 1) + '.';
       }
    }

    function startTest() {
      var nameInput = document.getElementById('inputName').value.trim();
      resultData.name = nameInput ? nameInput : 'XY';
      var count = parseInt(document.getElementById('inputCount').value);
      if (!count || count < 1) { alert('Poƒçet ot√°zok mus√≠ by≈• aspo≈à 1.'); return; }
      if (count > originalQuestions.length) count = originalQuestions.length;

      document.getElementById('startScreen').style.display = 'none';
      var form = document.getElementById('quizForm');
      form.style.display = 'block';
      form.innerHTML = '';

      window.qs = pick(originalQuestions, count)
                .map(function(q){ return { term: q.term, correct: q.correct, opts: shuffle([q.correct].concat(q.answers)), userAnswer: null, isCorrect: false }; });

      window.qs.forEach(function(q,i){
        var block = document.createElement('div'); block.className = 'question-block';
        var title = document.createElement('div'); title.className = 'question-title';
        title.textContent = getQuestionPrefix(i) + ' ' + q.term;
        block.appendChild(title);
        var ansContainer = document.createElement('div'); ansContainer.className = 'answers';
        q.opts.forEach(function(opt){
          var lbl = document.createElement('label');
          var rd = document.createElement('input'); rd.type = 'radio'; rd.name = 'q' + i; rd.value = opt;
          lbl.appendChild(rd);
          lbl.appendChild(document.createTextNode(' ' + opt));
          ansContainer.appendChild(lbl);
        });
        block.appendChild(ansContainer);
        form.appendChild(block);
      });

      var submitBtn = document.createElement('button');
      submitBtn.type = 'button';
      submitBtn.textContent = 'Vyhodnoti≈•';
      submitBtn.style.marginTop = '20px';
      submitBtn.style.padding = '15px 30px';
      submitBtn.style.fontSize = '1.3rem';
      submitBtn.style.backgroundColor = '#4CAF50';
      submitBtn.style.color = 'white';
      submitBtn.style.border = 'none';
      submitBtn.style.borderRadius = '5px';
      submitBtn.style.cursor = 'pointer';
      submitBtn.onclick = evaluateTest;
      form.appendChild(submitBtn);
      var resultsDiv = document.createElement('div'); resultsDiv.id = 'results'; form.appendChild(resultsDiv);
    }

    function evaluateTest() {
      var score = 0;
      var blocks = document.getElementsByClassName('question-block');
      var oldFbs = document.querySelectorAll('.feedback-msg');
      oldFbs.forEach(e => e.remove());

      Array.from(blocks).forEach(function(block, i){
        var elems = document.getElementsByName('q' + i);
        var selected = Array.from(elems).find(function(r){ return r.checked; });
        window.qs[i].userAnswer = selected ? selected.value : null;
        window.qs[i].isCorrect = (window.qs[i].userAnswer === window.qs[i].correct);

        Array.from(elems).forEach(function(r){
          r.parentNode.classList.remove('correct', 'incorrect', 'missing');
        });
        block.classList.remove('missing');

        var feedback = '';
        if (!selected) {
          block.classList.add('missing'); feedback = '‚ö†Ô∏è ch√Ωbaj√∫ca odpoveƒè';
          Array.from(elems).forEach(r => { if(r.value === window.qs[i].correct) r.parentNode.classList.add('correct'); });
        } else if (selected.value === window.qs[i].correct) {
          score++; feedback = '‚úÖ spr√°vna odpoveƒè';
          Array.from(elems).forEach(r => { if(r.value === window.qs[i].correct) r.parentNode.classList.add('correct'); });
        } else {
          feedback = '‚ùå nespr√°vna odpoveƒè';
          Array.from(elems).forEach(r => { 
             if(r.checked) r.parentNode.classList.add('incorrect');
             if(r.value === window.qs[i].correct) r.parentNode.classList.add('correct');
          });
        }
        var fbEl = document.createElement('div'); fbEl.className = 'feedback-msg';
        fbEl.style.fontWeight = 'bold'; fbEl.style.marginTop = '5px'; fbEl.textContent = feedback;
        block.appendChild(fbEl);
      });

      resultData.score = score;
      resultData.percent = Math.round(score / (window.qs.length || 1) * 100);
      resultData.date = new Date().toLocaleString();

      var out = document.getElementById('results');
      out.innerHTML = `<h3>Prehƒæad v√Ωsledkov</h3>
        <p><strong>N√°zov testu:</strong> ${testTitleName}</p>
        <p><strong>Meno ≈æiaka:</strong> ${resultData.name}</p>
        <p><strong>Bodov√© a percentu√°lne hodnotenie:</strong> ${resultData.score} / ${window.qs.length} (${resultData.percent} %)</p>
        <p><strong>D√°tum a ƒças:</strong> ${resultData.date}</p>`;

      var detailBtn = document.createElement('button');
      detailBtn.className = 'detail-btn';
      detailBtn.textContent = 'Detailn√© v√Ωsledky';
      detailBtn.onclick = openDetailedResults;
      out.appendChild(detailBtn);
    }

    function openDetailedResults() {
       var win = window.open('', '_blank');
       var css = `
         body { font-family: Courier bold, monospace; padding: 20px; }
         h2, h3 { border-bottom: 2px solid #ccc; padding-bottom: 10px; }
         table { width: 100%; border-collapse: collapse; margin-top: 20px; }
         th, td { border: 1px solid #999; padding: 10px; text-align: left; vertical-align: top; }
         th { background-color: #eee; }
         .symbol { font-size: 1.5em; font-weight: bold; }
         .correct-ans { color: green; font-weight: bold; }
         .user-wrong { color: red; text-decoration: line-through; }
         .legend { margin-top: 30px; border: 1px solid #ccc; padding: 10px; background: #f9f9f9; }
         @media print { button { display: none; } body { font-size: 12pt; } }
       `;
       var rows = '';
       window.qs.forEach(function(q, i) {
          var qPrefix = getQuestionPrefix(i);
          var symbol = '';
          var uAns = '';
          if (q.userAnswer === null) {
             symbol = '!';
             uAns = '<span style="color:#c27e00">(bez odpovede)</span>';
          } else if (q.isCorrect) {
             symbol = '‚úÖ';
             uAns = q.userAnswer;
          } else {
             symbol = '‚ùå';
             uAns = '<span class="user-wrong">' + q.userAnswer + '</span>';
          }
          rows += `<tr>
             <td><b>${qPrefix} ${q.term}</b><br><br>Spr√°vna odpoveƒè: <span class="correct-ans">${q.correct}</span></td>
             <td>${uAns}<br><br><span class="symbol">${symbol}</span></td>
          </tr>`;
       });

       var content = `
         <html><head><title>Detailn√© v√Ωsledky - ${resultData.name}</title><style>${css}</style></head><body>
         <h2>Detailn√© v√Ωsledky</h2>
         <p><strong>N√°zov testu:</strong> ${testTitleName}</p>
         <p><strong>Meno ≈æiaka:</strong> ${resultData.name}</p>
         <p><strong>Bodov√© a percentu√°lne hodnotenie:</strong> ${resultData.score} / ${window.qs.length} (${resultData.percent} %)</p>
         <p><strong>D√°tum a ƒças:</strong> ${resultData.date}</p>
         <h3>Detailn√Ω prehƒæad</h3>
         <table>
           <thead><tr><th style="width:60%">Zadanie a spr√°vna odpoveƒè</th><th>Odpoveƒè ≈æiaka a hodnotenie</th></tr></thead>
           <tbody>${rows}</tbody>
         </table>
         <div class="legend">
           <b>Legenda symbolov:</b><br>
           ‚úÖ = Spr√°vna odpoveƒè<br>
           ‚ùå = Nespr√°vna odpoveƒè<br>
           ! = ≈Ωiak neuviedol odpoveƒè
         </div>
         <br><button onclick="window.print()" style="padding:10px 20px; font-weight:bold; cursor:pointer;">üñ®Ô∏è Vytlaƒçi≈• (Ctrl + P)</button>
         </body></html>
       `;
       win.document.write(content);
       win.document.close();
    }
  </script>
  <br><br><b>Spracovala pomocou UI:</b> Mgr. Erika Matyiov√° (2025)<br><br>
</body>
</html>
