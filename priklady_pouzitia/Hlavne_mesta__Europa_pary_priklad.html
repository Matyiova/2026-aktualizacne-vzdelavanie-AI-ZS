<!DOCTYPE html>
<html lang="sk">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Hlavn√© mest√° (Eur√≥pa)</title>
<style>
:root{
  --bg: #ffffff; --fg: #111827; --card: #f0f0f0; --border: #999999;
  --active: #d0eaff; --control-bg: #ffffff; --control-fg: #000000;
  --end-bg: #ffffff; --end-fg: #111827;
  --card-width: 250px; --card-height: 165px; --card-gap: 12px;
}
body.dark-mode{
  --bg: #2e3d20; --fg: #f7f9ef; --card: #112409; --border: #ffffff;
  --active: #f7f9ef; --control-bg: #f7f9ef; --control-fg: #000000;
  --end-bg: #062d08; --end-fg: #e0f4d7;
}
.card.selected { background: var(--active, #d0eaff); color: #000000 !important; }
body.dark-mode .card.selected { background: var(--active, #f7f9ef); color: #000000 !important; }
body.dark-mode #endMessage { background: #304420; color: var(--end-fg); box-shadow: 0 6px 30px rgba(0,0,0,0.45); }
body{ margin:0; padding:24px; font-family: Courier, monospace; background:var(--bg); color:var(--fg); text-align:center; }
.controls, .card, #endMessage, button, input, select { transition: background-color .18s ease, color .18s ease, border-color .18s ease, box-shadow .18s ease; }
.card{ 
  width: var(--card-width); height: var(--card-height); 
  display:inline-flex; flex-direction: column; align-items:center; justify-content:center; 
  margin: calc(var(--card-gap) / 2); background:var(--card); border:3px solid var(--border); 
  border-radius:10px; cursor:pointer; user-select:none; 
  text-align:center; box-shadow:2px 2px 8px rgba(0,0,0,0.12); color:var(--fg); 
  font-family: 'Segoe UI', sans-serif; font-weight: bold; line-height: 1.15; padding: 4px; overflow: hidden;
}
.card.matched{ visibility:hidden; }
.card.selected{ background:var(--active); color:var(--fg); }
.card.correct{ background: #c8f7c5 !important; }
.card.wrong{ background: #f7c5c5 !important; }
.bold{ font-weight:800; }
.card:not(.selected).term { background: #d9d9d9; color: var(--fg); font-weight: 800; }
.card:not(.selected).definition { background: #f6f6f6; color: var(--fg); font-weight: 500; }
body.dark-mode .card:not(.selected).term { background: #112409; color: var(--fg); font-weight: 800; }
body.dark-mode .card:not(.selected).definition { background: #1d3d0f; color: var(--fg); font-weight: 500; }
#board{ display:flex; flex-wrap:wrap; justify-content:center; max-width:1200px; margin:18px auto; }
#endMessage{ display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); font-size:3rem; font-weight:800; background:var(--end-bg); color:var(--end-fg); padding:18px 26px; border-radius:12px; box-shadow:0 6px 30px rgba(0,0,0,0.25); z-index:999; pointer-events:none; text-align:center; }
.controls{ margin-bottom:12px; }
button, input, select{ padding:8px 10px; margin:6px; background:var(--control-bg); color:var(--control-fg); border:1px solid var(--border); border-radius:6px; }
@media(max-width:900px){ :root{ --card-width: 220px; --card-height: 150px; --card-gap: 10px; } #board{ max-width:980px; } }
@media(max-width:700px){ :root{ --card-width: 46%; --card-height: 110px; --card-gap: 8px; } #endMessage{ font-size:1.8rem; padding:14px 18px; } }
</style>
</head>
<body >
  <label class="controls"><input type="checkbox" id="darkToggle"> Tmav√Ω re≈æim</label>
  <h1>Hlavn√© mest√° (Eur√≥pa)</h1>
  <div class="controls">
    <label><input type="checkbox" id="toggleTimer"> Aktivova≈• ƒçasovaƒç</label><br>
    <span id="timerDisplay">ƒåas: 0.00 s</span><br>
    <span id="recordDisplay" style="margin-left:12px">Rekord: ‚Äì</span><br>
    <button id="restartBtn" style="margin-left:12px">üîÅ Re≈°tartova≈•</button>
  </div>
  <div id="board"></div>
  <div id="endMessage"></div>
<script>
(function(){
  const RAW_LINES = ["Franc√∫zsko\tPar√≠≈æ","Nemecko\tBerl√≠n","D√°nsko\tKoda≈à","F√≠nsko\tHelsinki","N√≥rsko\tOslo","≈†v√©dsko\tStockholm","Holandsko\tAmsterdam","Belgicko\tBrusel","Slovensko\tBratislava","ƒåesk√° republika\tPraha","Poƒæsko\tVar≈°ava","Maƒèarsko\tBudape≈°≈•","Rak√∫sko\tViede≈à"];
  const PAIR_COUNT = 6;
  const HIGHLIGHT = "term";
  const END_MESSAGES = ["Super! üôÇ","√ö≈æasn√©! üôÇ","V√Ωborne! üôÇ","Kto vie, ten vie üôÇ","Si ≈°ikovn√Ω/√° üôÇ","Cviƒçenie rob√≠ majstra üôÇ","Zasl√∫≈æi≈° si odmenu üôÇ"];
  
  function parsePairs(lines){
    const pairs = [];
    for(const rawLine of lines){
      if(!rawLine) continue;
      const parts = rawLine.split(/\t| - | : |;/).map(s => s.trim()).filter(Boolean);
      if(parts.length === 2) pairs.push([parts[0], parts[1]]);
    }
    return pairs;
  }
  function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; } return arr; }
  function allPairsFound(){ return document.querySelectorAll('.card:not(.matched)').length === 0; }
  const BEST_KEY = 'matchGameBestTime_export';
  let timerInterval = null, startTime = null;
  const toggleTimer = document.getElementById('toggleTimer');
  const timerDisplay = document.getElementById('timerDisplay');
  const recordDisplay = document.getElementById('recordDisplay');
  const endMessageEl = document.getElementById('endMessage');
  const DARK_KEY = 'exportGameDarkMode';
  (function restoreDarkMode() { try { const saved = localStorage.getItem(DARK_KEY); const darkOn = saved === '1'; document.body.classList.toggle('dark-mode', darkOn); const dt = document.getElementById('darkToggle'); if (dt) dt.checked = darkOn; } catch (e) {} })();
  const dtEl = document.getElementById('darkToggle');
  if (dtEl) { dtEl.addEventListener('change', function () { try { localStorage.setItem(DARK_KEY, this.checked ? '1' : '0'); } catch (e) {} document.body.classList.toggle('dark-mode', this.checked); }); }
  function refreshBest(){ const raw = localStorage.getItem(BEST_KEY); if(!raw){ recordDisplay.textContent = 'Rekord: ‚Äì'; return; } try{ const r=JSON.parse(raw); recordDisplay.textContent = 'Rekord: ' + r.time.toFixed(2) + ' s ('+r.date+' '+r.timeOfDay+')'; }catch(e){ recordDisplay.textContent = 'Rekord: ‚Äì'; } }
  refreshBest();
  function startTimer(){ stopTimer(); startTime = performance.now(); timerInterval = setInterval(()=>{ const elapsed = (performance.now()-startTime)/1000; timerDisplay.textContent = 'ƒåas: ' + elapsed.toFixed(2) + ' s'; if(allPairsFound()){ stopTimer(); saveIfBetter(elapsed); showEnd(); refreshBest(); } }, 100); }
  function stopTimer(){ clearInterval(timerInterval); timerInterval=null; }
  toggleTimer.addEventListener('change', ()=>{ if(toggleTimer.checked) startTimer(); else { stopTimer(); timerDisplay.textContent='ƒåas: 0.00 s'; } });
  const TIMER_KEY = 'exportGameTimerOn';
  (function restoreTimerToggle() { try { const saved = localStorage.getItem(TIMER_KEY); const timerOn = saved === '1'; if (toggleTimer) { toggleTimer.checked = timerOn; if (timerOn) { if (typeof startTimer === 'function') { startTimer(); } else { Promise.resolve().then(() => { if (typeof startTimer === 'function') startTimer(); }); } } } } catch (e) {} })();
  if (toggleTimer) { toggleTimer.addEventListener('change', function () { try { localStorage.setItem(TIMER_KEY, this.checked ? '1' : '0'); } catch (e) {} try { if (this.checked) startTimer(); else stopTimer(); } catch (e) {} }); }

  function saveIfBetter(elapsed){ const raw = localStorage.getItem(BEST_KEY); let isNew = false; if(!raw) isNew = true; else { try{ const p = JSON.parse(raw); if(elapsed < p.time) isNew = true; }catch(e){} } if(isNew){ const now=new Date(); localStorage.setItem(BEST_KEY, JSON.stringify({time: elapsed, date: now.toLocaleDateString(), timeOfDay: now.toLocaleTimeString()})); } }
  function showEnd(){ const msg = END_MESSAGES[Math.floor(Math.random()*END_MESSAGES.length)]; endMessageEl.textContent = msg; endMessageEl.style.display = 'block'; endMessageEl.style.opacity = '1'; setTimeout(()=>{ endMessageEl.style.transition='opacity 700ms ease'; endMessageEl.style.opacity='0'; setTimeout(()=>{ endMessageEl.style.display='none'; endMessageEl.style.transition=''; endMessageEl.style.opacity='1'; },700); },1500); }

  function formatCardText(text){
    if(!text) return "";
    if(text.includes(' ') && text.length < 50) return text.replace(/\s+/g, '<br>');
    return text;
  }
  function autoFitText(element) {
    let size = 34; const minSize = 10; element.style.fontSize = size + "px";
    while ((element.scrollHeight > element.clientHeight || element.scrollWidth > element.clientWidth) && size > minSize) {
        size--; element.style.fontSize = size + "px";
    }
  }

  const pairs = parsePairs(RAW_LINES);
  const pick = shuffle(pairs.slice()).slice(0, Math.min(PAIR_COUNT, pairs.length));
  let cards = [];
  pick.forEach((p,i)=>{ cards.push({id:i,text:p[0],type:'term'}); cards.push({id:i,text:p[1],type:'definition'}); });
  shuffle(cards);
  const board = document.getElementById('board');
  board.innerHTML = '';
  cards.forEach(c=>{
    const d = document.createElement('div');
    d.className = 'card ' + (c.type === 'term' ? 'term' : 'definition');
    if(HIGHLIGHT === 'term' && c.type === 'term') d.classList.add('bold');
    if(HIGHLIGHT === 'definition' && c.type === 'definition') d.classList.add('bold');
    d.innerHTML = formatCardText(c.text); 
    d.dataset.pairId = c.id; board.appendChild(d); 
    d.addEventListener('click', ()=> onClick(d));
    autoFitText(d);
  });
  let first=null, second=null;
  function onClick(el){ if(el.classList.contains('matched') || el.classList.contains('selected')) return; el.classList.add('selected'); if(!first){ first = el; return; } second = el; 
  // OPRAVA: Pou≈æitie ID namiesto porovn√°vania textu pre spr√°vne fungovanie viacslovn√Ωch pojmov
  const isMatch = first.dataset.pairId === second.dataset.pairId; 
  if(isMatch && first !== second){ first.classList.add('correct'); second.classList.add('correct'); setTimeout(()=>{ first.classList.add('matched'); second.classList.add('matched'); first.classList.remove('correct','selected'); second.classList.remove('correct','selected'); first=second=null; if(toggleTimer.checked){} else if(!document.querySelector('.card:not(.matched)')) showEnd(); },120); } else { first.classList.add('wrong'); second.classList.add('wrong'); setTimeout(()=>{ first.classList.remove('wrong','selected'); second.classList.remove('wrong','selected'); first=second=null; },300); } }
  document.getElementById('darkToggle').addEventListener('change', function(){ document.body.classList.toggle('dark-mode', this.checked); });
  document.getElementById('restartBtn').addEventListener('click', function(){ location.reload(); });
})();
</script>
<br><br>
  <b>Spracovan√© pomocou UI:</b> ¬© Mgr. Erika Matyiov√° (2026)
  <br><br>
</body>
</html>